{% extends "base.html" %}

{% block content %}
    <h4> Hi {{current_user.name}}, here are your messages: </h4>
    <form action="" method="POST", novalidate>
        {{ form.hidden_tag() }}

        <div>
            {{ form.message.label }}
            {{ form.message(size=200) }}
            {{ form.send() }}
        </div>
    </form>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
        console.log("WE have a script")
        $(document).ready(function() {
            var socket = io.connect('http://' + document.domain + ':' + location.port)
            console.log("This is the current user: ", current_user.id)
            socket.on(''+current_user.id, function(msg) {
                $('#log').append('<p> Received new message </p>')
            });
        });
    </script>
    {% for message in messages %}
        <p> <b> {{ message.give_name(current_user.id) }}: </b> {{ message.content }} </p>
    {% endfor %}
{% endblock %}